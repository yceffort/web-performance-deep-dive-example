<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê°€ìƒ ìŠ¤í¬ë¡¤ ìµœì í™” ì˜ˆì œ - 3-3-1</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          sans-serif;
        padding: 40px;
        background: #f5f5f5;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        background: white;
        padding: 40px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      h1 {
        margin-bottom: 10px;
        color: #333;
      }

      .description {
        color: #666;
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .instructions {
        background: #fffbeb;
        border: 1px solid #fbbf24;
        border-radius: 6px;
        padding: 20px;
        margin-bottom: 30px;
      }

      .instructions h3 {
        color: #92400e;
        margin-bottom: 10px;
      }

      .instructions ol {
        margin-left: 20px;
        color: #78350f;
        line-height: 1.8;
      }

      .instructions code {
        background: #fef3c7;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: 'Courier New', monospace;
      }

      .comparison {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-bottom: 30px;
      }

      .example-box {
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        padding: 20px;
        background: #f9fafb;
      }

      .example-box.bad {
        border-color: #ef4444;
      }

      .example-box.good {
        border-color: #10b981;
      }

      .example-box h2 {
        margin-bottom: 10px;
        font-size: 18px;
      }

      .example-box.bad h2 {
        color: #dc2626;
      }

      .example-box.good h2 {
        color: #059669;
      }

      .example-box p {
        color: #666;
        font-size: 14px;
        margin-bottom: 15px;
        line-height: 1.6;
      }

      .buttons {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
      }

      button {
        padding: 10px 20px;
        font-size: 14px;
        font-weight: 600;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .btn-danger {
        background: #ef4444;
        color: white;
      }

      .btn-danger:hover {
        background: #dc2626;
      }

      .btn-success {
        background: #10b981;
        color: white;
      }

      .btn-success:hover {
        background: #059669;
      }

      .btn-primary {
        background: #3b82f6;
        color: white;
      }

      .btn-primary:hover {
        background: #2563eb;
      }

      .result {
        margin-top: 10px;
        padding: 12px;
        background: white;
        border-radius: 4px;
        font-size: 13px;
      }

      .result.error {
        border-left: 4px solid #ef4444;
        background: #fef2f2;
      }

      .result.success {
        border-left: 4px solid #10b981;
        background: #f0fdf4;
      }

      .list-container {
        height: 400px;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        background: white;
        overflow: auto;
        margin-top: 15px;
        position: relative;
      }

      .list-item {
        padding: 10px 15px;
        border-bottom: 1px solid #f3f4f6;
        font-size: 14px;
      }

      .list-item:hover {
        background: #f9fafb;
      }

      .time {
        font-weight: 700;
        color: #3b82f6;
      }

      .time.long-task {
        color: #ef4444;
      }

      /* ê°€ìƒ ìŠ¤í¬ë¡¤ìš© ìŠ¤íƒ€ì¼ */
      .virtual-scroll-container {
        height: 400px;
        overflow: auto;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        margin-top: 15px;
        position: relative;
      }

      .virtual-scroll-content {
        position: relative;
      }

      .virtual-item {
        position: absolute;
        left: 0;
        right: 0;
        padding: 10px 15px;
        border-bottom: 1px solid #f3f4f6;
        background: white;
      }

      @media (max-width: 1024px) {
        .comparison {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>âš¡ ê°€ìƒ ìŠ¤í¬ë¡¤ ìµœì í™” ì˜ˆì œ</h1>
      <p class="description">
        ì´ í˜ì´ì§€ëŠ” 3-3-1ì ˆ "Performance íƒ­ì—ì„œ Long Task ì°¾ê¸°"ì˜ ê°€ìƒ ìŠ¤í¬ë¡¤
        ìµœì í™”ë¥¼ ìœ„í•œ ì‹¤ìŠµ ì˜ˆì œì…ë‹ˆë‹¤.<br />
        ì¼ë°˜ ë Œë”ë§ê³¼ ê°€ìƒ ìŠ¤í¬ë¡¤ì˜ ì„±ëŠ¥ ì°¨ì´ë¥¼ Performance íƒ­ì—ì„œ ë¹„êµí•  ìˆ˜
        ìˆìŠµë‹ˆë‹¤.
      </p>

      <div class="instructions">
        <h3>ğŸ“¸ Performance íƒ­ ìº¡ì³ ë°©ë²•</h3>
        <ol>
          <li>Chrome DevToolsë¥¼ ì—½ë‹ˆë‹¤ (F12 ë˜ëŠ” Cmd+Option+I)</li>
          <li><code>Performance</code> íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤</li>
          <li>ë…¹í™” ë²„íŠ¼(âš«ï¸)ì„ í´ë¦­í•˜ê±°ë‚˜ Cmd+Eë¥¼ ëˆ„ë¦…ë‹ˆë‹¤</li>
          <li>
            ì•„ë˜ <strong>ë¹¨ê°„ ë²„íŠ¼</strong> ë˜ëŠ”
            <strong>ì´ˆë¡ ë²„íŠ¼</strong>ì„ í´ë¦­í•©ë‹ˆë‹¤
          </li>
          <li>1-2ì´ˆ í›„ ë…¹í™”ë¥¼ ì •ì§€í•©ë‹ˆë‹¤</li>
          <li>Main íŠ¸ë™ì—ì„œ Long Task ìœ ë¬´ë¥¼ ë¹„êµí•©ë‹ˆë‹¤</li>
        </ol>
      </div>

      <div class="comparison">
        <!-- Bad: ì¼ë°˜ ë Œë”ë§ -->
        <div class="example-box bad">
          <h2>ğŸ”´ Bad: ì¼ë°˜ ë Œë”ë§ (Long Task ë°œìƒ)</h2>
          <p>
            10,000ê°œ ì•„ì´í…œì„ í•œ ë²ˆì— ë Œë”ë§í•©ë‹ˆë‹¤. DOMì— ëª¨ë“  ìš”ì†Œê°€ ì¶”ê°€ë˜ì–´
            Long Taskê°€ ë°œìƒí•˜ê³  ë©”ì¸ ìŠ¤ë ˆë“œê°€ ë¸”ë¡œí‚¹ë©ë‹ˆë‹¤.
          </p>
          <div class="buttons">
            <button class="btn-danger" onclick="loadBadExample()">
              ğŸ”´ 10,000ê°œ ë Œë”ë§
            </button>
            <button class="btn-primary" onclick="clearBadExample()">
              ğŸ—‘ï¸ ì´ˆê¸°í™”
            </button>
          </div>
          <div id="bad-result"></div>
          <div id="bad-list" class="list-container" style="display: none"></div>
        </div>

        <!-- Good: ê°€ìƒ ìŠ¤í¬ë¡¤ -->
        <div class="example-box good">
          <h2>âœ… Good: ê°€ìƒ ìŠ¤í¬ë¡¤ (Long Task ì—†ìŒ)</h2>
          <p>
            ê°€ìƒ ìŠ¤í¬ë¡¤ì„ ì‚¬ìš©í•˜ì—¬ í™”ë©´ì— ë³´ì´ëŠ” ì•„ì´í…œë§Œ ë Œë”ë§í•©ë‹ˆë‹¤. 10,000ê°œ
            ë°ì´í„°ì§€ë§Œ ì´ˆê¸° ë Œë”ë§ì€ 30-50ms ì´í•˜ë¡œ ì™„ë£Œë©ë‹ˆë‹¤.
          </p>
          <div class="buttons">
            <button class="btn-success" onclick="loadGoodExample()">
              âœ… 10,000ê°œ ë Œë”ë§ (ìµœì í™”)
            </button>
            <button class="btn-primary" onclick="clearGoodExample()">
              ğŸ—‘ï¸ ì´ˆê¸°í™”
            </button>
          </div>
          <div id="good-result"></div>
          <div
            id="good-list"
            class="virtual-scroll-container"
            style="display: none"
          ></div>
        </div>
      </div>
    </div>

    <script>
      // 10,000ê°œ ê°€ì§œ ë°ì´í„° ìƒì„±
      const generateItems = (count) =>
        Array.from({ length: count }, (_, i) => ({
          id: i,
          text: `ì•„ì´í…œ ${i + 1}`,
          description: `ì´ê²ƒì€ ${i + 1}ë²ˆì§¸ ì•„ì´í…œì…ë‹ˆë‹¤. ê°€ìƒ ìŠ¤í¬ë¡¤ í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ì…ë‹ˆë‹¤.`,
        }))

      // ============================================
      // Bad ì˜ˆì œ: ì¼ë°˜ ë Œë”ë§ (Long Task ë°œìƒ)
      // ============================================
      function loadBadExample() {
        const startTime = performance.now()
        const container = document.getElementById('bad-list')
        const resultDiv = document.getElementById('bad-result')

        container.innerHTML = ''
        container.style.display = 'block'

        const items = generateItems(10000)

        // Long Task ë°œìƒ: 10,000ê°œ ëª¨ë‘ DOMì— ì¶”ê°€
        let html = ''
        items.forEach((item) => {
          html += `
            <div class="list-item">
              <strong>${item.text}</strong>
              <div style="font-size: 12px; color: #666;">${item.description}</div>
            </div>
          `
        })
        container.innerHTML = html

        const duration = performance.now() - startTime

        resultDiv.className = `result ${duration > 50 ? 'error' : 'success'}`
        resultDiv.innerHTML = `
          <strong>ë Œë”ë§ ì™„ë£Œ</strong><br>
          ì†Œìš” ì‹œê°„: <span class="time ${duration > 50 ? 'long-task' : ''}">${duration.toFixed(2)}ms</span><br>
          ${duration > 50 ? 'âš ï¸ Long Task ë°œìƒ! Performance íƒ­ì—ì„œ ë¹¨ê°„ìƒ‰ ì‚¼ê°í˜• í™•ì¸' : 'âœ… ì •ìƒ ì‘ì—…'}
        `
      }

      function clearBadExample() {
        document.getElementById('bad-list').style.display = 'none'
        document.getElementById('bad-list').innerHTML = ''
        document.getElementById('bad-result').innerHTML = ''
      }

      // ============================================
      // Good ì˜ˆì œ: ê°€ìƒ ìŠ¤í¬ë¡¤ (Long Task ì—†ìŒ)
      // ============================================
      const ITEM_HEIGHT = 60
      const VISIBLE_ITEMS = Math.ceil(400 / ITEM_HEIGHT) + 2 // ë²„í¼ í¬í•¨

      function loadGoodExample() {
        const startTime = performance.now()
        const container = document.getElementById('good-list')
        const resultDiv = document.getElementById('good-result')

        container.innerHTML = ''
        container.style.display = 'block'

        const items = generateItems(10000)

        // ê°€ìƒ ìŠ¤í¬ë¡¤ êµ¬í˜„
        const content = document.createElement('div')
        content.className = 'virtual-scroll-content'
        content.style.height = `${items.length * ITEM_HEIGHT}px`
        container.appendChild(content)

        let visibleItems = []

        function renderVisibleItems() {
          const scrollTop = container.scrollTop
          const startIndex = Math.floor(scrollTop / ITEM_HEIGHT)
          const endIndex = Math.min(startIndex + VISIBLE_ITEMS, items.length)

          // ê¸°ì¡´ ì•„ì´í…œ ì œê±°
          visibleItems.forEach((item) => item.element.remove())
          visibleItems = []

          // ë³´ì´ëŠ” ì•„ì´í…œë§Œ ë Œë”ë§
          for (let i = startIndex; i < endIndex; i++) {
            const item = items[i]
            const element = document.createElement('div')
            element.className = 'virtual-item'
            element.style.top = `${i * ITEM_HEIGHT}px`
            element.style.height = `${ITEM_HEIGHT}px`
            element.innerHTML = `
              <strong>${item.text}</strong>
              <div style="font-size: 12px; color: #666;">${item.description}</div>
            `
            content.appendChild(element)
            visibleItems.push({ item, element })
          }
        }

        // ì´ˆê¸° ë Œë”ë§
        renderVisibleItems()

        // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸
        container.addEventListener('scroll', renderVisibleItems)

        const duration = performance.now() - startTime

        resultDiv.className = 'result success'
        resultDiv.innerHTML = `
          <strong>ë Œë”ë§ ì™„ë£Œ (ê°€ìƒ ìŠ¤í¬ë¡¤)</strong><br>
          ì†Œìš” ì‹œê°„: <span class="time">${duration.toFixed(2)}ms</span><br>
          âœ… Long Task ì—†ìŒ! í™”ë©´ì— ë³´ì´ëŠ” ${VISIBLE_ITEMS}ê°œë§Œ ë Œë”ë§<br>
          <small style="color: #666;">ìŠ¤í¬ë¡¤í•´ë„ ê° ì—…ë°ì´íŠ¸ëŠ” 10ms ì´í•˜ë¡œ ìœ ì§€ë©ë‹ˆë‹¤.</small>
        `
      }

      function clearGoodExample() {
        document.getElementById('good-list').style.display = 'none'
        document.getElementById('good-list').innerHTML = ''
        document.getElementById('good-result').innerHTML = ''
      }
    </script>
  </body>
</html>
