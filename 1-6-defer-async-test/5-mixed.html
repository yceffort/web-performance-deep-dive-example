<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5. í˜¼í•© (defer + async)</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        max-width: 800px;
        margin: 40px auto;
        padding: 20px;
        background: #f5f5f5;
      }
      .card {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      h1 {
        color: #805ad5;
      }
      pre {
        background: #1a202c;
        color: #f7fafc;
        padding: 15px;
        border-radius: 4px;
        overflow-x: auto;
      }
      .info {
        background: #faf5ff;
        border-left: 4px solid #805ad5;
        padding: 15px;
        margin: 15px 0;
      }
      code {
        background: #edf2f7;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: 'Monaco', 'Courier New', monospace;
      }
      .defer {
        color: #38a169;
      }
      .async {
        color: #3182ce;
      }
    </style>

    <script>
      console.log('â° [inline] <head> ì‹œì‘ -', new Date().toISOString())
    </script>

    <!-- âœ… defer ìŠ¤í¬ë¦½íŠ¸ - ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ -->
    <script defer src="./scripts/light-script.js"></script>

    <!-- ğŸ“Š async ìŠ¤í¬ë¦½íŠ¸ - ë¶„ì„ ì½”ë“œ -->
    <script async src="./scripts/analytics.js"></script>

    <script>
      console.log('â° [inline] <head> ë -', new Date().toISOString())

      // DOMContentLoaded ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document.addEventListener('DOMContentLoaded', () => {
        console.log('ğŸ‰ [DOMContentLoaded] ë°œìƒ -', new Date().toISOString())

        const eventLog = document.getElementById('event-log')
        if (eventLog) {
          eventLog.textContent = 'âœ… DOMContentLoaded ë°œìƒ ì™„ë£Œ'
        }
      })
    </script>
  </head>
  <body>
    <script>
      console.log('â° [inline] <body> ì‹œì‘ -', new Date().toISOString())
    </script>

    <div class="card">
      <h1>ğŸ¨ ì‹œë‚˜ë¦¬ì˜¤ 5: í˜¼í•© (defer + async)</h1>
      <p>ì‹¤ë¬´ì—ì„œ ê°€ì¥ í”í•œ íŒ¨í„´: deferì™€ asyncë¥¼ í•¨ê»˜ ì‚¬ìš©</p>
      <ul>
        <li>
          <span class="defer">defer</span>: ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ (light-script.js)
        </li>
        <li><span class="async">async</span>: ë¶„ì„ ì½”ë“œ (analytics.js)</li>
      </ul>
    </div>

    <div class="card">
      <h2>ğŸ“‹ í…ŒìŠ¤íŠ¸ ë°©ë²•</h2>
      <ol>
        <li>í¬ë¡¬ ê°œë°œì ë„êµ¬ ì—´ê¸° (F12)</li>
        <li><strong>Performance íƒ­</strong> ì„ íƒ</li>
        <li>ì™¼ìª½ ìœ„ <strong>Record ë²„íŠ¼ (â—)</strong> í´ë¦­</li>
        <li><strong>í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨</strong> (Cmd+R ë˜ëŠ” Ctrl+R)</li>
        <li>ëª‡ ì´ˆ í›„ <strong>Stop ë²„íŠ¼ (â– )</strong> í´ë¦­</li>
      </ol>
    </div>

    <div class="card">
      <h2>ğŸ” í™•ì¸ ì‚¬í•­</h2>
      <div class="info">
        <strong>ğŸ¨ í˜¼í•© ì‚¬ìš© ë™ì‘:</strong>
        <ul>
          <li>
            <span class="async">async</span> ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìš´ë¡œë“œ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ (ì˜ˆì¸¡
            ë¶ˆê°€)
          </li>
          <li>
            <span class="defer">defer</span> ìŠ¤í¬ë¦½íŠ¸ëŠ” HTML íŒŒì‹± ì™„ë£Œ í›„, HTML
            ìˆœì„œëŒ€ë¡œ ì‹¤í–‰
          </li>
          <li>
            DOMContentLoadedëŠ” <span class="defer">defer</span> ìŠ¤í¬ë¦½íŠ¸ë§Œ ê¸°ë‹¤ë¦¼
          </li>
          <li>
            <span class="async">async</span> ìŠ¤í¬ë¦½íŠ¸ëŠ” DOMContentLoaded ì „í›„ ì–¸ì œë“ 
            ì‹¤í–‰ ê°€ëŠ¥
          </li>
        </ul>
      </div>
    </div>

    <div class="card">
      <h2>ğŸ“Š ì˜ˆìƒ íƒ€ì„ë¼ì¸ (ê²½ìš° 1: asyncê°€ ë¹ ë¥¸ ê²½ìš°)</h2>
      <pre>
Main Thread:
â”œâ”€ Parse HTML (0~300ms)
â”œâ”€ Evaluate Script - analytics.js (300~310ms) â† async ë¨¼ì €
â”œâ”€ Parse HTML (310~500ms)
â”œâ”€ Evaluate Script - light-script.js (500~510ms) â† defer
â””â”€ DOMContentLoaded (510ms)
      </pre>
    </div>

    <div class="card">
      <h2>ğŸ“Š ì˜ˆìƒ íƒ€ì„ë¼ì¸ (ê²½ìš° 2: asyncê°€ ëŠë¦° ê²½ìš°)</h2>
      <pre>
Main Thread:
â”œâ”€ Parse HTML (0~500ms)
â”œâ”€ Evaluate Script - light-script.js (500~510ms) â† defer
â”œâ”€ DOMContentLoaded (510ms)
â””â”€ Evaluate Script - analytics.js (800ms) â† async ë‚˜ì¤‘ì—
      </pre>
    </div>

    <div class="card">
      <h2>ğŸ“ ì½˜ì†” ì¶œë ¥ (ë‹¤ì–‘í•œ ìˆœì„œ ê°€ëŠ¥)</h2>
      <p><strong>ê²½ìš° 1: asyncê°€ ë¨¼ì € ì‹¤í–‰</strong></p>
      <ol>
        <li><code>â° [inline] &lt;head&gt; ì‹œì‘</code></li>
        <li><code>â° [inline] &lt;head&gt; ë</code></li>
        <li><code>â° [inline] &lt;body&gt; ì‹œì‘</code></li>
        <li>
          <code>ğŸ“Š [analytics.js] ì‹¤í–‰ ì‹œì‘</code>
          <span class="async">â† async (íŒŒì‹± ì¤‘)</span>
        </li>
        <li><code>ğŸ“Š [analytics.js] ì‹¤í–‰ ì™„ë£Œ</code></li>
        <li><code>â° [inline] &lt;body&gt; ë</code></li>
        <li>
          <code>âœ… [light-script.js] ì‹¤í–‰ ì‹œì‘</code>
          <span class="defer">â† defer (íŒŒì‹± ì™„ë£Œ í›„)</span>
        </li>
        <li><code>âœ… [light-script.js] ì‹¤í–‰ ì™„ë£Œ</code></li>
        <li><code>ğŸ‰ [DOMContentLoaded] ë°œìƒ</code></li>
      </ol>

      <p><strong>ê²½ìš° 2: deferê°€ ë¨¼ì € ì‹¤í–‰</strong></p>
      <ol>
        <li><code>â° [inline] &lt;head&gt; ì‹œì‘</code></li>
        <li><code>â° [inline] &lt;head&gt; ë</code></li>
        <li><code>â° [inline] &lt;body&gt; ì‹œì‘</code></li>
        <li><code>â° [inline] &lt;body&gt; ë</code></li>
        <li>
          <code>âœ… [light-script.js] ì‹¤í–‰ ì‹œì‘</code>
          <span class="defer">â† defer (íŒŒì‹± ì™„ë£Œ í›„)</span>
        </li>
        <li><code>âœ… [light-script.js] ì‹¤í–‰ ì™„ë£Œ</code></li>
        <li><code>ğŸ‰ [DOMContentLoaded] ë°œìƒ</code></li>
        <li>
          <code>ğŸ“Š [analytics.js] ì‹¤í–‰ ì‹œì‘</code>
          <span class="async">â† async (DOMContentLoaded í›„)</span>
        </li>
        <li><code>ğŸ“Š [analytics.js] ì‹¤í–‰ ì™„ë£Œ</code></li>
      </ol>
    </div>

    <div class="card">
      <h2>ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸</h2>
      <ul>
        <li>
          <span class="defer">defer</span>ì™€ <span class="async">async</span>ëŠ” í•¨ê»˜
          ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
        </li>
        <li>
          ê° ìŠ¤í¬ë¦½íŠ¸ëŠ” ë…ë¦½ì ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤ (ì„œë¡œ ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŒ)
        </li>
        <li>
          DOMContentLoadedëŠ” <span class="defer">defer</span> ìŠ¤í¬ë¦½íŠ¸ë§Œ ê¸°ë‹¤ë¦½ë‹ˆë‹¤
        </li>
        <li>
          <span class="async">async</span> ìŠ¤í¬ë¦½íŠ¸ëŠ” DOMContentLoadedì™€ ë¬´ê´€í•˜ê²Œ
          ì‹¤í–‰ë©ë‹ˆë‹¤
        </li>
      </ul>
    </div>

    <div class="card">
      <h2>ğŸ’¡ ì‹¤ë¬´ íŒ¨í„´</h2>
      <pre style="background: white; color: #2d3748; border: 1px solid #cbd5e0;">
&lt;head&gt;
  &lt;!-- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜: defer (ìˆœì„œ ë³´ì¥) --&gt;
  &lt;script defer src="/vendor.js"&gt;&lt;/script&gt;
  &lt;script defer src="/app.js"&gt;&lt;/script&gt;

  &lt;!-- ë¶„ì„ ë° ì¶”ì : async (ìµœëŒ€í•œ ë¹¨ë¦¬) --&gt;
  &lt;script async src="/analytics.js"&gt;&lt;/script&gt;
  &lt;script async src="/sentry.js"&gt;&lt;/script&gt;

  &lt;!-- ê´‘ê³ : async (ë…ë¦½ì ) --&gt;
  &lt;script async src="/ads.js"&gt;&lt;/script&gt;
&lt;/head&gt;
      </pre>
      <p>
        ì´ë ‡ê²Œ í•˜ë©´ ë©”ì¸ ê¸°ëŠ¥ì€ ìˆœì„œëŒ€ë¡œ ì•ˆì „í•˜ê²Œ ë¡œë“œë˜ê³ , ë¶€ê°€ ê¸°ëŠ¥ì€ ìµœëŒ€í•œ ë¹¨ë¦¬
        ë¡œë“œë©ë‹ˆë‹¤.
      </p>
    </div>

    <div class="card">
      <h2>ğŸ“Š ë‹¤ë¥¸ ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ</h2>
      <ul>
        <li><a href="./1-normal.html">1-normal.html</a>: ì¼ë°˜ ìŠ¤í¬ë¦½íŠ¸ (blocking)</li>
        <li>
          <a href="./2-defer-light.html">2-defer-light.html</a>: defer ìŠ¤í¬ë¦½íŠ¸
          (ê°€ë²¼ìš´)
        </li>
        <li>
          <a href="./3-defer-heavy.html">3-defer-heavy.html</a>: defer ìŠ¤í¬ë¦½íŠ¸
          (ë¬´ê±°ìš´) â­
        </li>
        <li><a href="./4-async.html">4-async.html</a>: async ìŠ¤í¬ë¦½íŠ¸</li>
        <li><strong>í˜„ì¬ í˜ì´ì§€</strong>: í˜¼í•© (defer + async)</li>
      </ul>
    </div>

    <div class="card">
      <h2>âœ… ì´ë²¤íŠ¸ ìƒíƒœ</h2>
      <p id="event-log">ëŒ€ê¸° ì¤‘...</p>
    </div>

    <script>
      console.log('â° [inline] <body> ë -', new Date().toISOString())
    </script>
  </body>
</html>
