<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. defer ìŠ¤í¬ë¦½íŠ¸ (ë¬´ê±°ìš´) - í•µì‹¬ í…ŒìŠ¤íŠ¸</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        max-width: 800px;
        margin: 40px auto;
        padding: 20px;
        background: #f5f5f5;
      }
      .card {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      h1 {
        color: #d69e2e;
      }
      pre {
        background: #1a202c;
        color: #f7fafc;
        padding: 15px;
        border-radius: 4px;
        overflow-x: auto;
      }
      .highlight {
        background: #fffaf0;
        border-left: 4px solid #d69e2e;
        padding: 15px;
        margin: 15px 0;
      }
      code {
        background: #edf2f7;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: 'Monaco', 'Courier New', monospace;
      }
      .star {
        font-size: 24px;
        color: #d69e2e;
      }
    </style>

    <script>
      console.log('â° [inline] <head> ì‹œì‘ -', new Date().toISOString())
    </script>

    <!-- â­ defer ìŠ¤í¬ë¦½íŠ¸ (ë¬´ê±°ìš´ ì‹¤í–‰) - í•µì‹¬ í…ŒìŠ¤íŠ¸ -->
    <script defer src="./scripts/heavy-script.js"></script>

    <script>
      console.log('â° [inline] <head> ë (deferëŠ” ë¸”ë¡œí‚¹ ì•ˆ í•¨) -', new Date().toISOString())

      // DOMContentLoaded ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document.addEventListener('DOMContentLoaded', () => {
        console.log('ğŸ‰ [DOMContentLoaded] ë°œìƒ -', new Date().toISOString())

        const eventLog = document.getElementById('event-log')
        if (eventLog) {
          eventLog.textContent = 'âœ… DOMContentLoaded ë°œìƒ ì™„ë£Œ'
        }
      })
    </script>
  </head>
  <body>
    <script>
      console.log('â° [inline] <body> ì‹œì‘ -', new Date().toISOString())
    </script>

    <div class="card">
      <h1>â­ ì‹œë‚˜ë¦¬ì˜¤ 3: defer ìŠ¤í¬ë¦½íŠ¸ (ë¬´ê±°ìš´) - í•µì‹¬ í…ŒìŠ¤íŠ¸</h1>
      <p>
        ë¬´ê±°ìš´ <code>&lt;script defer&gt;</code>ëŠ” DOMContentLoadedë¥¼ ì§€ì—°ì‹œí‚µë‹ˆë‹¤.
      </p>
      <p class="star">â­ ì´ê²ƒì´ 1-6-2-1ì ˆì—ì„œ ì„¤ëª…í•œ í•µì‹¬ ë‚´ìš©ì…ë‹ˆë‹¤!</p>
    </div>

    <div class="card">
      <h2>ğŸ“‹ í…ŒìŠ¤íŠ¸ ë°©ë²•</h2>
      <ol>
        <li>í¬ë¡¬ ê°œë°œì ë„êµ¬ ì—´ê¸° (F12)</li>
        <li><strong>Performance íƒ­</strong> ì„ íƒ</li>
        <li>ì™¼ìª½ ìœ„ <strong>Record ë²„íŠ¼ (â—)</strong> í´ë¦­</li>
        <li><strong>í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨</strong> (Cmd+R ë˜ëŠ” Ctrl+R)</li>
        <li>ëª‡ ì´ˆ í›„ <strong>Stop ë²„íŠ¼ (â– )</strong> í´ë¦­</li>
      </ol>
    </div>

    <div class="card">
      <h2>ğŸ” í™•ì¸ ì‚¬í•­ - í•µì‹¬! â­</h2>
      <div class="highlight">
        <strong>â­ 1-6-2-1ì ˆì˜ ë‚´ìš©ì„ ê²€ì¦í•©ë‹ˆë‹¤:</strong>
        <blockquote style="margin: 15px 0; padding-left: 15px; border-left: 3px solid #d69e2e;">
          ë§Œì•½ <code>defer</code> ìŠ¤í¬ë¦½íŠ¸ê°€ ë¬´ê²ë‹¤ë©´, "Parse HTML" ì™„ë£Œì™€
          "DOMContentLoaded" ì‚¬ì´ì— ê¸´ "Evaluate Script" êµ¬ê°„ì´ ë³´ì¼ ê²ƒì´ë‹¤.
        </blockquote>
        <ul>
          <li>"Parse HTML" ì™„ë£Œ ì‹œì  í™•ì¸ (ì˜ˆ: 500ms)</li>
          <li>
            <strong>"Parse HTML" ì™„ë£Œì™€ "DOMContentLoaded" ì‚¬ì´ì— ê¸´ "Evaluate Script"
              êµ¬ê°„ í™•ì¸</strong>
            (ì•½ 1000ms = 1ì´ˆ)
          </li>
          <li>DOMContentLoadedê°€ heavy-script.js ì‹¤í–‰ ì™„ë£Œ í›„ ë°œìƒ</li>
          <li>íƒ€ì„ë¼ì¸ì—ì„œ ëª…í™•í•œ ê°„ê²©(gap)ì´ ë³´ì—¬ì•¼ í•¨</li>
        </ul>
      </div>
    </div>

    <div class="card">
      <h2>ğŸ“Š ì˜ˆìƒ íƒ€ì„ë¼ì¸</h2>
      <pre>
Main Thread:
â”œâ”€ Parse HTML (0~500ms) â† ì¤‘ë‹¨ ì—†ìŒ
â”œâ”€ Evaluate Script - heavy-script.js (500~1500ms) â† ê¸´ ì‹¤í–‰ ì‹œê°„ (1ì´ˆ)
â””â”€ DOMContentLoaded (1500ms) â† ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì™„ë£Œ í›„

â­ "Parse HTML" ì™„ë£Œ(500ms)ì™€ "DOMContentLoaded"(1500ms) ì‚¬ì´ì—
   ê¸´ "Evaluate Script" êµ¬ê°„(1000ms)ì´ ìˆìŒ!
      </pre>
    </div>

    <div class="card">
      <h2>ğŸ“ ì½˜ì†” ì¶œë ¥</h2>
      <p>ì½˜ì†”ì—ì„œ ë‹¤ìŒ ìˆœì„œë¡œ ë¡œê·¸ê°€ ì¶œë ¥ë©ë‹ˆë‹¤:</p>
      <ol>
        <li><code>â° [inline] &lt;head&gt; ì‹œì‘</code></li>
        <li><code>â° [inline] &lt;head&gt; ë</code></li>
        <li><code>â° [inline] &lt;body&gt; ì‹œì‘</code></li>
        <li><code>â° [inline] &lt;body&gt; ë</code></li>
        <li>
          <code>ğŸ”´ [heavy-script.js] ì‹¤í–‰ ì‹œì‘</code> â­ (HTML íŒŒì‹± ì™„ë£Œ í›„)
        </li>
        <li>
          <code>ğŸ”´ [heavy-script.js] ì‹¤í–‰ ì™„ë£Œ - ~1000ms</code> â­ (ê¸´ ì‹¤í–‰
          ì‹œê°„)
        </li>
        <li>
          <code>ğŸ‰ [DOMContentLoaded] ë°œìƒ</code> â­ (ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì™„ë£Œ í›„)
        </li>
      </ol>
    </div>

    <div class="card">
      <h2>ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸</h2>
      <ul>
        <li>defer ìŠ¤í¬ë¦½íŠ¸ëŠ” HTML íŒŒì‹±ì„ ë¸”ë¡œí‚¹í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</li>
        <li>
          <strong>í•˜ì§€ë§Œ DOMContentLoadedëŠ” defer ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì™„ë£Œë¥¼
            ê¸°ë‹¤ë¦½ë‹ˆë‹¤</strong>
        </li>
        <li>ë¬´ê±°ìš´ defer ìŠ¤í¬ë¦½íŠ¸ëŠ” DOMContentLoadedë¥¼ ì§€ì—°ì‹œí‚µë‹ˆë‹¤</li>
        <li>
          Performance íƒ­ì—ì„œ "Parse HTML" ì™„ë£Œì™€ "DOMContentLoaded" ì‚¬ì´ì˜ ê°„ê²©ì„ í™•ì¸í• 
          ìˆ˜ ìˆìŠµë‹ˆë‹¤
        </li>
      </ul>
    </div>

    <div class="card">
      <h2>ğŸ’¡ ì‹¤ë¬´ ì ìš©</h2>
      <p>ì´ í…ŒìŠ¤íŠ¸ê°€ ì¤‘ìš”í•œ ì´ìœ :</p>
      <ul>
        <li>deferë¥¼ ì‚¬ìš©í•´ë„ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œê°„ì€ ì¤‘ìš”í•©ë‹ˆë‹¤</li>
        <li>ë¬´ê±°ìš´ ë²ˆë“¤ì€ ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…ìœ¼ë¡œ ë‚˜ëˆ ì•¼ í•©ë‹ˆë‹¤</li>
        <li>ì´ˆê¸° ë¡œë”©ì— í•„ìš” ì—†ëŠ” ì½”ë“œëŠ” ë™ì  importë¡œ ì§€ì—° ë¡œë”©í•´ì•¼ í•©ë‹ˆë‹¤</li>
        <li>Performance íƒ­ìœ¼ë¡œ ì´ëŸ° ë¬¸ì œë¥¼ ì§„ë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
      </ul>
    </div>

    <div class="card">
      <h2>ğŸ“Š ë¹„êµí•˜ê¸°</h2>
      <ul>
        <li>
          <a href="./2-defer-light.html">2-defer-light.html</a>: ê°€ë²¼ìš´ defer
          ìŠ¤í¬ë¦½íŠ¸ (~10ms)
        </li>
        <li>
          <strong>í˜„ì¬ í˜ì´ì§€</strong>: ë¬´ê±°ìš´ defer ìŠ¤í¬ë¦½íŠ¸ (~1000ms = 1ì´ˆ)
        </li>
        <li>ì°¨ì´: DOMContentLoadedê¹Œì§€ì˜ ì‹œê°„ì´ 990ms ë” ê±¸ë¦¼</li>
      </ul>
    </div>

    <div class="card">
      <h2>âœ… ì´ë²¤íŠ¸ ìƒíƒœ</h2>
      <p id="event-log">ëŒ€ê¸° ì¤‘...</p>
      <p style="color: #718096; font-size: 14px; margin-top: 10px;">
        (heavy-script.js ì‹¤í–‰ ì¤‘ì—ëŠ” ì•„ë¬´ê²ƒë„ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì‹¤í–‰ ì™„ë£Œ í›„
        DOMContentLoadedê°€ ë°œìƒí•˜ê³  ìœ„ í…ìŠ¤íŠ¸ê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.)
      </p>
    </div>

    <script>
      console.log('â° [inline] <body> ë -', new Date().toISOString())
    </script>
  </body>
</html>
