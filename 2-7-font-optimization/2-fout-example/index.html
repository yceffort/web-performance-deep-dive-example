<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FOUT (Flash of Unstyled Text) ì˜ˆì œ</title>
    <style>
      @font-face {
        font-family: 'CustomFont';
        src: url('/fonts/custom-font.woff2') format('woff2');
        font-display: swap; /* ì¦‰ì‹œ í´ë°± í°íŠ¸ë¡œ í‘œì‹œ, ì›¹ í°íŠ¸ ë¡œë“œ í›„ êµì²´ */
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        /* CustomFontëŠ” Robotoë¡œ, Arialê³¼ëŠ” ë©”íŠ¸ë¦­ì´ ë‹¤ë¦„ */
        font-family: 'CustomFont', Arial, sans-serif;
        font-size: 20px;
        padding: 40px;
        line-height: 1.6;
        max-width: 900px;
        margin: 0 auto;
      }

      .info-box {
        background: #d4edda;
        border: 2px solid #28a745;
        padding: 20px;
        margin-bottom: 30px;
        border-radius: 8px;
      }

      .info-box h2 {
        margin-bottom: 10px;
        color: #155724;
      }

      .info-box p {
        color: #155724;
        margin-bottom: 10px;
      }

      .content {
        background: white;
        padding: 30px;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      h1 {
        font-size: 48px;
        margin-bottom: 20px;
        color: #2c3e50;
        font-weight: 700;
      }

      .description {
        background: #e8f4f8;
        padding: 15px;
        margin: 20px 0;
        border-left: 4px solid #3498db;
      }

      .box-below {
        margin-top: 30px;
        padding: 20px;
        background: #ffebee;
        border: 2px solid #e74c3c;
        border-radius: 8px;
      }

      .box-below h3 {
        color: #c0392b;
        margin-bottom: 10px;
      }

      .status {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #fff;
        padding: 15px 20px;
        border: 2px solid #333;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        min-width: 280px;
        z-index: 1000;
      }

      .status h3 {
        margin-bottom: 10px;
        font-size: 16px;
      }

      .status .metric {
        display: flex;
        justify-content: space-between;
        margin: 5px 0;
        font-size: 14px;
      }

      .status .metric strong {
        color: #e74c3c;
      }

      .status .metric.good strong {
        color: #27ae60;
      }

      .status .metric.warning strong {
        color: #f39c12;
      }

      .cls-visualization {
        margin-top: 30px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .timeline {
        margin-top: 20px;
        padding: 15px;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 4px;
        max-height: 300px;
        overflow-y: auto;
      }

      .timeline-item {
        padding: 8px 0;
        border-bottom: 1px solid #eee;
        font-size: 13px;
      }

      .timeline-item:last-child {
        border-bottom: none;
      }

      .timeline-item .time {
        font-weight: bold;
        color: #3498db;
      }

      .timeline-item.shift {
        color: #e74c3c;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="info-box">
      <h2>âœ¨ FOUT (Flash of Unstyled Text) í˜„ìƒ</h2>
      <p>
        <strong
          >ì´ í˜ì´ì§€ëŠ” font-display: swapì„ ì‚¬ìš©í•˜ì—¬ ì¦‰ì‹œ í…ìŠ¤íŠ¸ë¥¼
          í‘œì‹œí•©ë‹ˆë‹¤.</strong
        >
      </p>
      <p>
        ë¨¼ì € Arial í´ë°± í°íŠ¸ë¡œ í…ìŠ¤íŠ¸ê°€ ë³´ì´ê³ , ì•½ 2ì´ˆ í›„ CustomFontë¡œ
        êµì²´ë˜ë©´ì„œ í™”ë©´ì´ "ê¹œë¹¡ì´ëŠ”" ê²ƒì„ í™•ì¸í•˜ì„¸ìš”.
      </p>
      <p>í°íŠ¸ê°€ êµì²´ë  ë•Œ ë ˆì´ì•„ì›ƒ ì‹œí”„íŠ¸(CLS)ê°€ ë°œìƒí•˜ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.</p>
    </div>

    <div class="status" id="status">
      <h3>ğŸ“Š ì„±ëŠ¥ ì§€í‘œ</h3>
      <div class="metric">
        <span>í°íŠ¸ ìƒíƒœ:</span>
        <strong id="font-status">í´ë°± í°íŠ¸ (Arial)</strong>
      </div>
      <div class="metric">
        <span>ê²½ê³¼ ì‹œê°„:</span>
        <strong id="elapsed-time">0ms</strong>
      </div>
      <div class="metric good">
        <span>FCP:</span>
        <strong id="fcp-time">-</strong>
      </div>
      <div class="metric warning">
        <span>ëˆ„ì  CLS:</span>
        <strong id="cls-score">0</strong>
      </div>
      <div class="metric">
        <span>Layout Shifts:</span>
        <strong id="shift-count">0</strong>
      </div>
    </div>

    <div class="content">
      <h1>ì´ ì œëª©ì€ ì¦‰ì‹œ Arialë¡œ í‘œì‹œë©ë‹ˆë‹¤</h1>

      <div class="description">
        <p>
          <strong>FOUTë€?</strong> Flash of Unstyled Textì˜ ì•½ìë¡œ, í´ë°±
          í°íŠ¸ë¡œ í…ìŠ¤íŠ¸ë¥¼ ë¨¼ì € í‘œì‹œí•œ ë’¤ ì›¹ í°íŠ¸ê°€ ë¡œë“œë˜ë©´ êµì²´í•˜ë©´ì„œ í™”ë©´ì´
          "ê¹œë¹¡ì´ëŠ”" í˜„ìƒì…ë‹ˆë‹¤.
        </p>
      </div>

      <p>
        CustomFontê°€ ë¡œë“œë˜ë©´ í°íŠ¸ê°€ Arialì—ì„œ CustomFontë¡œ ë°”ë€Œë©´ì„œ í…ìŠ¤íŠ¸
        ë†’ì´ê°€ ë³€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í´ë°± í°íŠ¸ì™€ ì›¹ í°íŠ¸ì˜ í¬ê¸°(font metrics)ê°€
        ë‹¤ë¥´ë©´, í°íŠ¸ê°€ ë°”ë€” ë•Œ í…ìŠ¤íŠ¸ ë†’ì´ê°€ ë³€í•˜ê³  ë ˆì´ì•„ì›ƒì´ ì´ë™í•©ë‹ˆë‹¤.
      </p>

      <p>
        ì˜ˆë¥¼ ë“¤ì–´ Arialë¡œ ë Œë”ë§ëœ ì´ ë¬¸ë‹¨ì´ 100px ë†’ì´ì˜€ëŠ”ë°, CustomFontë¡œ
        ë°”ë€Œë©´ì„œ 110pxê°€ ë˜ë©´ ì•„ë˜ ë¹¨ê°„ìƒ‰ ë°•ìŠ¤ê°€ 10px ì•„ë˜ë¡œ ë°€ë¦½ë‹ˆë‹¤. ì´ê²ƒì´
        CLS(Cumulative Layout Shift)ë¡œ ì¸¡ì •ë©ë‹ˆë‹¤.
      </p>

      <h2>ì¥ì ê³¼ ë‹¨ì </h2>

      <p>
        <strong>ì¥ì :</strong> FOITë¥¼ ë°©ì§€í•˜ì—¬ í…ìŠ¤íŠ¸ê°€ ì¦‰ì‹œ í‘œì‹œë˜ë¯€ë¡œ FCPì™€
        LCPê°€ ë¹ ë¥´ê²Œ ì¸¡ì •ë©ë‹ˆë‹¤. ì‚¬ìš©ìëŠ” í˜ì´ì§€ê°€ ë¡œë“œë˜ìë§ˆì ì½˜í…ì¸ ë¥¼ ì½ì„
        ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>

      <p>
        <strong>ë‹¨ì :</strong> í°íŠ¸ê°€ êµì²´ë  ë•Œ ì‹œê°ì ìœ¼ë¡œ "ê¹œë¹¡ì„"ì´ ë°œìƒí•˜ê³ ,
        í°íŠ¸ ë©”íŠ¸ë¦­ ì°¨ì´ë¡œ ì¸í•´ CLSê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>

      <div class="box-below">
        <h3>âš ï¸ ì´ ë°•ìŠ¤ê°€ ìœ„ í…ìŠ¤íŠ¸ ë†’ì´ ë³€í™”ì— ë”°ë¼ ì´ë™í•©ë‹ˆë‹¤</h3>
        <p>
          í°íŠ¸ê°€ ë¡œë“œë˜ì–´ êµì²´ë  ë•Œ ìœ„ í…ìŠ¤íŠ¸ì˜ ë†’ì´ê°€ ë°”ë€Œë©´, ì´ ë°•ìŠ¤ì˜ ìœ„ì¹˜ê°€
          ì´ë™í•©ë‹ˆë‹¤. Chrome DevToolsì˜ Performance íŒ¨ë„ì—ì„œ Layout Shiftë¥¼
          í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>
      </div>

      <div class="cls-visualization">
        <h3>ğŸ“ ì´ë²¤íŠ¸ íƒ€ì„ë¼ì¸</h3>
        <div class="timeline" id="timeline"></div>
      </div>
    </div>

    <script>
      const startTime = performance.now()
      const timelineEvents = []
      let clsScore = 0
      let shiftCount = 0

      function addTimelineEvent(message, isShift = false) {
        const elapsed = Math.round(performance.now() - startTime)
        timelineEvents.push({ time: elapsed, message, isShift })
        updateTimeline()
      }

      function updateTimeline() {
        const container = document.getElementById('timeline')
        container.innerHTML = timelineEvents
          .map(
            (event) =>
              `<div class="timeline-item ${event.isShift ? 'shift' : ''}">
                <span class="time">${event.time}ms:</span> ${event.message}
              </div>`,
          )
          .join('')
      }

      function updateElapsedTime() {
        const elapsed = Math.round(performance.now() - startTime)
        document.getElementById('elapsed-time').textContent = `${elapsed}ms`
      }

      addTimelineEvent('í˜ì´ì§€ ë¡œë“œ ì‹œì‘')
      setInterval(updateElapsedTime, 100)

      // FCP ì¸¡ì •
      const paintObserver = new PerformanceObserver((list) => {
        for (const entry of list.getEntries()) {
          if (entry.name === 'first-contentful-paint') {
            const fcpTime = Math.round(entry.startTime)
            document.getElementById('fcp-time').textContent = `${fcpTime}ms`
            addTimelineEvent(`âœ“ FCP ë°œìƒ: ${fcpTime}ms (í´ë°± í°íŠ¸ë¡œ ì¦‰ì‹œ í‘œì‹œ)`)
          }
        }
      })
      paintObserver.observe({ type: 'paint', buffered: true })

      // CLS ì¸¡ì •
      const clsObserver = new PerformanceObserver((list) => {
        for (const entry of list.getEntries()) {
          if (!entry.hadRecentInput) {
            clsScore += entry.value
            shiftCount++

            document.getElementById('cls-score').textContent =
              clsScore.toFixed(4)
            document.getElementById('shift-count').textContent = shiftCount

            const clsMetric = document.querySelector(
              '.status .metric.warning strong',
            )
            if (clsScore > 0.1) {
              clsMetric.style.color = '#e74c3c'
              clsMetric.parentElement.classList.remove('warning')
            }

            addTimelineEvent(
              `âš ï¸ Layout Shift ë°œìƒ! ê°’: ${entry.value.toFixed(4)}, ëˆ„ì  CLS: ${clsScore.toFixed(4)}`,
              true,
            )

            console.log('Layout Shift ìƒì„¸ ì •ë³´:', {
              value: entry.value,
              sources: entry.sources,
              totalCLS: clsScore,
            })
          }
        }
      })
      clsObserver.observe({ type: 'layout-shift', buffered: true })

      // í°íŠ¸ ë¡œë”© ìƒíƒœ í™•ì¸
      let fontLoaded = false

      function checkFontLoaded() {
        if (fontLoaded) return

        if (document.fonts.check('20px CustomFont')) {
          fontLoaded = true
          const elapsed = Math.round(performance.now() - startTime)

          document.getElementById('font-status').textContent = 'CustomFont ë¡œë“œë¨'
          document.getElementById('font-status').style.color = '#27ae60'

          addTimelineEvent(`âœ“ CustomFont ë¡œë“œ ì™„ë£Œ: ${elapsed}ms`)
          addTimelineEvent(
            'í°íŠ¸ê°€ Arialì—ì„œ CustomFontë¡œ êµì²´ë˜ì—ˆìŠµë‹ˆë‹¤. CLS ë°œìƒ ê°€ëŠ¥.',
          )

          // í°íŠ¸ êµì²´ í›„ 100ms ëŒ€ê¸°í•˜ì—¬ CLS í™•ì¸
          setTimeout(() => {
            if (clsScore === 0) {
              addTimelineEvent(
                'âœ“ CLS ë°œìƒí•˜ì§€ ì•ŠìŒ (í°íŠ¸ ë©”íŠ¸ë¦­ì´ ìœ ì‚¬í•¨)',
              )
            } else {
              addTimelineEvent(
                `âš ï¸ ìµœì¢… CLS: ${clsScore.toFixed(4)} (0.1 ì´í•˜ê°€ "ì¢‹ìŒ")`,
              )
            }
          }, 100)

          return
        }

        setTimeout(checkFontLoaded, 50)
      }

      document.fonts.ready.then(() => {
        checkFontLoaded()
      })

      checkFontLoaded()

      // DOMContentLoaded
      document.addEventListener('DOMContentLoaded', () => {
        const elapsed = Math.round(performance.now() - startTime)
        addTimelineEvent(`DOMContentLoaded: ${elapsed}ms`)
      })

      // í˜ì´ì§€ ì™„ì „ ë¡œë“œ
      window.addEventListener('load', () => {
        const elapsed = Math.round(performance.now() - startTime)
        addTimelineEvent(`í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ: ${elapsed}ms`)
      })

      // 5ì´ˆ í›„ ìµœì¢… ìš”ì•½
      setTimeout(() => {
        addTimelineEvent('=== ì¸¡ì • ì™„ë£Œ ===')
        addTimelineEvent(
          `ìµœì¢… ê²°ê³¼: FCPëŠ” ë¹ ë¥´ê²Œ ë°œìƒí–ˆì§€ë§Œ, CLSê°€ ${clsScore.toFixed(4)} ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,
        )
      }, 5000)
    </script>
  </body>
</html>
