<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>font-display: optional ì˜ˆì œ</title>
    <style>
      @font-face {
        font-family: 'OptionalFont';
        src: url('/fonts/optional-font-slow.woff2') format('woff2');
        font-weight: 400;
        font-style: normal;
        font-display: optional; /* 100ms ì•ˆì— ë¡œë“œ ì•ˆë˜ë©´ í¬ê¸° */
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          'OptionalFont',
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          Arial,
          sans-serif;
        font-size: 20px;
        padding: 40px;
        line-height: 1.6;
        max-width: 900px;
        margin: 0 auto;
      }

      .info-box {
        background: #d4edda;
        border: 2px solid #28a745;
        padding: 20px;
        margin-bottom: 30px;
        border-radius: 8px;
      }

      .info-box h2 {
        margin-bottom: 10px;
        color: #155724;
      }

      .info-box p {
        color: #155724;
        margin-bottom: 10px;
      }

      .info-box.slow {
        background: #fff3cd;
        border-color: #ffc107;
      }

      .info-box.slow h2,
      .info-box.slow p {
        color: #856404;
      }

      .content {
        background: white;
        padding: 30px;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      h1 {
        font-size: 48px;
        margin-bottom: 20px;
        color: #2c3e50;
      }

      .description {
        background: #e8f4f8;
        padding: 15px;
        margin: 20px 0;
        border-left: 4px solid #3498db;
      }

      .status {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #fff;
        padding: 15px 20px;
        border: 2px solid #333;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        min-width: 300px;
        z-index: 1000;
      }

      .status h3 {
        margin-bottom: 10px;
        font-size: 16px;
      }

      .status .metric {
        display: flex;
        justify-content: space-between;
        margin: 5px 0;
        font-size: 14px;
      }

      .status .metric strong {
        color: #e74c3c;
      }

      .status .metric.good strong {
        color: #27ae60;
      }

      .controls {
        margin: 30px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .controls h3 {
        margin-bottom: 15px;
      }

      .controls button {
        padding: 10px 20px;
        margin: 5px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        transition: all 0.2s;
      }

      .controls button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .controls button.fast {
        background: #27ae60;
        color: white;
      }

      .controls button.slow {
        background: #f39c12;
        color: white;
      }

      .timeline {
        margin-top: 30px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .timeline-events {
        max-height: 400px;
        overflow-y: auto;
        padding: 15px;
        background: white;
        border-radius: 4px;
      }

      .timeline-item {
        padding: 8px 0;
        border-bottom: 1px solid #eee;
        font-size: 13px;
      }

      .timeline-item:last-child {
        border-bottom: none;
      }

      .timeline-item .time {
        font-weight: bold;
        color: #3498db;
      }

      .timeline-item.important {
        color: #e74c3c;
        font-weight: bold;
      }

      .timeline-item.success {
        color: #27ae60;
        font-weight: bold;
      }

      .comparison-box {
        margin-top: 30px;
        padding: 20px;
        background: #fff3cd;
        border: 2px solid #ffc107;
        border-radius: 8px;
      }

      .comparison-box h3 {
        color: #856404;
        margin-bottom: 15px;
      }

      .comparison-box table {
        width: 100%;
        border-collapse: collapse;
        background: white;
      }

      .comparison-box th,
      .comparison-box td {
        padding: 10px;
        text-align: left;
        border: 1px solid #ddd;
      }

      .comparison-box th {
        background: #f8f9fa;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="info-box" id="info-box">
      <h2>ğŸ¯ font-display: optional ì „ëµ</h2>
      <p id="info-text">
        <strong
          >í˜„ì¬ ëª¨ë“œ: ëŠë¦° í°íŠ¸ (200ms ì§€ì—°) - optionalì€ í¬ê¸°í•˜ê³  í´ë°± í°íŠ¸
          ì‚¬ìš©</strong
        >
      </p>
      <p>
        font-display: optionalì€ ì•½ 100msì˜ ì§§ì€ block period ë™ì•ˆë§Œ í°íŠ¸ë¥¼
        ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
      </p>
      <p>
        100ms ì•ˆì— í°íŠ¸ê°€ ë¡œë“œë˜ì§€ ì•Šìœ¼ë©´ í´ë°± í°íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©°, ì´í›„ í°íŠ¸ê°€
        ë„ì°©í•´ë„ ì ˆëŒ€ êµì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
      </p>
    </div>

    <div class="status" id="status">
      <h3>ğŸ“Š ì„±ëŠ¥ ì§€í‘œ</h3>
      <div class="metric">
        <span>í°íŠ¸ ìƒíƒœ:</span>
        <strong id="font-status">í™•ì¸ ì¤‘...</strong>
      </div>
      <div class="metric">
        <span>ë¡œë“œ ì‹œê°„:</span>
        <strong id="load-time">-</strong>
      </div>
      <div class="metric">
        <span>100ms ì´ë‚´?</span>
        <strong id="within-100ms">-</strong>
      </div>
      <div class="metric good">
        <span>ëˆ„ì  CLS:</span>
        <strong id="cls-score">0</strong>
      </div>
      <div class="metric">
        <span>Layout Shifts:</span>
        <strong id="shift-count">0</strong>
      </div>
    </div>

    <div class="content">
      <h1>font-display: optional í…ŒìŠ¤íŠ¸</h1>

      <div class="description">
        <p>
          <strong>optionalì˜ íŠ¹ì§•:</strong> "ë ˆì´ì•„ì›ƒ ì‹œí”„íŠ¸ë¥¼ ì ˆëŒ€ ë°œìƒì‹œí‚¤ì§€
          ì•ŠëŠ”ë‹¤"ëŠ” ì „ëµì…ë‹ˆë‹¤. 100ms ì•ˆì— í°íŠ¸ê°€ ë„ì°©í•˜ì§€ ì•Šìœ¼ë©´ í´ë°± í°íŠ¸ë¥¼
          ì‚¬ìš©í•˜ë©° ì´í›„ ì ˆëŒ€ êµì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ FOUTê°€ ë°œìƒí•˜ì§€ ì•Šê³  CLSë„
          ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        </p>
      </div>

      <p>
        í˜„ì¬ ì´ í˜ì´ì§€ëŠ” í°íŠ¸ë¥¼ 200ms ì§€ì—°ìœ¼ë¡œ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” optionalì˜
        100ms block periodë¥¼ ì´ˆê³¼í•˜ë¯€ë¡œ, ë¸Œë¼ìš°ì €ëŠ” í°íŠ¸ ë‹¤ìš´ë¡œë“œë¥¼ í¬ê¸°í•˜ê³ 
        ì‹œìŠ¤í…œ í°íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
      </p>

      <p>
        ì´ í…ìŠ¤íŠ¸ëŠ” OptionalFontë¡œ ì •ì˜ë˜ì–´ ìˆì§€ë§Œ, ì‹¤ì œë¡œëŠ” ì‹œìŠ¤í…œ í°íŠ¸
        (Arial, -apple-system ë“±)ë¡œ ë Œë”ë§ë  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. í°íŠ¸ê°€ ë‚˜ì¤‘ì—
        ë„ì°©í•´ë„ êµì²´ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
      </p>

      <h2>ì¥ì </h2>

      <p>
        <strong>CLS ì™„ì „ ì°¨ë‹¨:</strong> í°íŠ¸ êµì²´ê°€ ì ˆëŒ€ ì¼ì–´ë‚˜ì§€ ì•Šìœ¼ë¯€ë¡œ í°íŠ¸
        ë¡œë”©ìœ¼ë¡œ ì¸í•œ ë ˆì´ì•„ì›ƒ ì‹œí”„íŠ¸ê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•µì‹¬ ì›¹ ì§€í‘œì—ì„œ CLS
        ì ìˆ˜ 0.1 ì´í•˜ê°€ "ì¢‹ìŒ"ìœ¼ë¡œ í‰ê°€ë˜ëŠ”ë°, optionalì„ ì‚¬ìš©í•˜ë©´ í°íŠ¸ ê´€ë ¨
        CLSë¥¼ ì™„ì „íˆ ì°¨ë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>

      <p>
        <strong>ëŒ€ì—­í­ ì ˆì•½:</strong> ëŠë¦° ë„¤íŠ¸ì›Œí¬ì—ì„œ í°íŠ¸ ë‹¤ìš´ë¡œë“œë¥¼ í¬ê¸°í•˜ì—¬
        ë¶ˆí•„ìš”í•œ ëŒ€ì—­í­ ì‚¬ìš©ì„ ì¤„ì…ë‹ˆë‹¤.
      </p>

      <h2>ë‹¨ì </h2>

      <p>
        <strong>ì¼ê´€ì„± ì—†ëŠ” ë””ìì¸:</strong> ëŠë¦° ë„¤íŠ¸ì›Œí¬ì—ì„œëŠ” ì›¹ í°íŠ¸ê°€ ì „í˜€
        ì ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¹ ë¥¸ ì—°ê²°ì—ì„œëŠ” ë¸Œëœë“œ í°íŠ¸ë¥¼ ë³´ê³ , ëŠë¦° ì—°ê²°ì—ì„œëŠ”
        ì‹œìŠ¤í…œ í°íŠ¸ë¥¼ ë³´ëŠ” ìƒí™©ì´ ë°œìƒí•©ë‹ˆë‹¤.
      </p>

      <div class="controls">
        <h3>ğŸ§ª ë‹¤ë¥¸ ëª¨ë“œë¡œ í…ŒìŠ¤íŠ¸í•´ë³´ê¸°</h3>
        <p style="font-size: 14px; color: #666; margin-bottom: 15px">
          í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ë‹¤ë¥¸ í°íŠ¸ ë¡œë”© ì†ë„ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>
        <button class="fast" onclick="location.href='/?mode=fast'">
          ë¹ ë¥¸ í°íŠ¸ ëª¨ë“œ (50ms) - optional ì ìš©
        </button>
        <button class="slow" onclick="location.href='/?mode=slow'">
          ëŠë¦° í°íŠ¸ ëª¨ë“œ (200ms) - optional í¬ê¸°
        </button>
      </div>

      <div class="comparison-box">
        <h3>ğŸ“Š swap vs optional ë¹„êµ</h3>
        <table>
          <thead>
            <tr>
              <th>í•­ëª©</th>
              <th>font-display: swap</th>
              <th>font-display: optional</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Block period</td>
              <td>0 (ì¦‰ì‹œ í´ë°± í‘œì‹œ)</td>
              <td>~100ms</td>
            </tr>
            <tr>
              <td>Swap period</td>
              <td>ë¬´í•œ (í•­ìƒ êµì²´)</td>
              <td>0 (ì ˆëŒ€ êµì²´ ì•ˆí•¨)</td>
            </tr>
            <tr>
              <td>FOUT ë°œìƒ</td>
              <td>ì˜ˆ</td>
              <td>ì•„ë‹ˆì˜¤</td>
            </tr>
            <tr>
              <td>CLS ìœ„í—˜</td>
              <td>ìˆìŒ</td>
              <td>ì—†ìŒ</td>
            </tr>
            <tr>
              <td>ëŠë¦° ë„¤íŠ¸ì›Œí¬</td>
              <td>ì›¹ í°íŠ¸ í™•ì‹¤íˆ ì ìš©</td>
              <td>ì‹œìŠ¤í…œ í°íŠ¸ ì‚¬ìš©</td>
            </tr>
            <tr>
              <td>ì í•©í•œ ìš©ë„</td>
              <td>ë¸Œëœë“œ ì¼ê´€ì„± ì¤‘ìš”</td>
              <td>ì„±ëŠ¥ ìµœìš°ì„ , CLS ì°¨ë‹¨</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="timeline">
        <h3>ğŸ“ ì´ë²¤íŠ¸ íƒ€ì„ë¼ì¸</h3>
        <div class="timeline-events" id="timeline"></div>
      </div>
    </div>

    <script>
      const startTime = performance.now()
      const timelineEvents = []
      let clsScore = 0
      let shiftCount = 0

      // URL íŒŒë¼ë¯¸í„° í™•ì¸
      const urlParams = new URLSearchParams(window.location.search)
      const mode = urlParams.get('mode') || 'slow'

      // ëª¨ë“œì— ë”°ë¼ í°íŠ¸ URL ë³€ê²½
      if (mode === 'fast') {
        // CSSë¥¼ ë™ì ìœ¼ë¡œ ìˆ˜ì •í•˜ì—¬ ë¹ ë¥¸ í°íŠ¸ ì‚¬ìš©
        const style = document.createElement('style')
        style.textContent = `
          @font-face {
            font-family: 'OptionalFont';
            src: url('/fonts/optional-font-fast.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
            font-display: optional;
          }
        `
        document.head.appendChild(style)

        document.getElementById('info-box').classList.remove('slow')
        document.getElementById('info-text').innerHTML =
          '<strong>í˜„ì¬ ëª¨ë“œ: ë¹ ë¥¸ í°íŠ¸ (50ms) - optionalì´ ì ìš©ë  ìˆ˜ ìˆìŒ</strong>'
      }

      function addTimelineEvent(message, type = 'normal') {
        const elapsed = Math.round(performance.now() - startTime)
        timelineEvents.push({ time: elapsed, message, type })
        updateTimeline()
      }

      function updateTimeline() {
        const container = document.getElementById('timeline')
        container.innerHTML = timelineEvents
          .map(
            (event) =>
              `<div class="timeline-item ${event.type}">
                <span class="time">${event.time}ms:</span> ${event.message}
              </div>`,
          )
          .join('')
        container.scrollTop = container.scrollHeight
      }

      addTimelineEvent(`í˜ì´ì§€ ë¡œë“œ ì‹œì‘ (ëª¨ë“œ: ${mode})`)

      // CLS ì¸¡ì •
      const clsObserver = new PerformanceObserver((list) => {
        for (const entry of list.getEntries()) {
          if (!entry.hadRecentInput) {
            clsScore += entry.value
            shiftCount++

            document.getElementById('cls-score').textContent =
              clsScore.toFixed(4)
            document.getElementById('shift-count').textContent = shiftCount

            addTimelineEvent(
              `âš ï¸ Layout Shift ë°œìƒ! ê°’: ${entry.value.toFixed(4)}`,
              'important',
            )
          }
        }
      })
      clsObserver.observe({ type: 'layout-shift', buffered: true })

      // í°íŠ¸ ë¡œë”© ìƒíƒœ í™•ì¸
      const fontCheckStart = performance.now()
      let fontApplied = false
      let checkCount = 0

      function checkFontLoaded() {
        checkCount++
        const elapsed = Math.round(performance.now() - fontCheckStart)

        if (document.fonts.check('20px OptionalFont')) {
          if (!fontApplied) {
            fontApplied = true
            const loadTime = Math.round(performance.now() - startTime)

            document.getElementById('font-status').textContent =
              'OptionalFont ì ìš©ë¨'
            document.getElementById('font-status').style.color = '#27ae60'
            document.getElementById('load-time').textContent = `${loadTime}ms`

            if (loadTime <= 100) {
              document.getElementById('within-100ms').textContent = 'âœ“ ì˜ˆ'
              document.getElementById('within-100ms').style.color = '#27ae60'
              addTimelineEvent(
                `âœ“ OptionalFont ë¡œë“œ ì™„ë£Œ: ${loadTime}ms (100ms ì´ë‚´)`,
                'success',
              )
            } else {
              document.getElementById('within-100ms').textContent = 'âœ— ì•„ë‹ˆì˜¤'
              addTimelineEvent(
                `âœ“ OptionalFont ë¡œë“œ ì™„ë£Œ: ${loadTime}ms (í•˜ì§€ë§Œ 100ms ì´ˆê³¼)`,
              )
            }
          }
          return
        }

        // 100ms ì²´í¬í¬ì¸íŠ¸
        if (elapsed > 100 && elapsed < 110 && !fontApplied) {
          document.getElementById('font-status').textContent =
            'ì‹œìŠ¤í…œ í°íŠ¸ ì‚¬ìš© (100ms ì´ˆê³¼)'
          document.getElementById('font-status').style.color = '#f39c12'
          document.getElementById('within-100ms').textContent = 'âœ— ì•„ë‹ˆì˜¤'
          addTimelineEvent(
            'â³ 100ms ì´ˆê³¼: optionalì´ í°íŠ¸ ë¡œë“œë¥¼ í¬ê¸°í•˜ê³  ì‹œìŠ¤í…œ í°íŠ¸ ì‚¬ìš©',
            'important',
          )
        }

        if (checkCount < 100) {
          setTimeout(checkFontLoaded, 50)
        }
      }

      document.fonts.ready.then(() => {
        const elapsed = Math.round(performance.now() - startTime)
        addTimelineEvent(`document.fonts.ready: ${elapsed}ms`)
        checkFontLoaded()
      })

      checkFontLoaded()

      // 5ì´ˆ í›„ ìµœì¢… ìš”ì•½
      setTimeout(() => {
        addTimelineEvent('=== ì¸¡ì • ì™„ë£Œ ===')

        if (clsScore === 0) {
          addTimelineEvent('âœ“ CLS ì—†ìŒ! optionalì´ ë ˆì´ì•„ì›ƒ ì‹œí”„íŠ¸ë¥¼ ë°©ì§€í–ˆìŠµë‹ˆë‹¤.', 'success')
        } else {
          addTimelineEvent(
            `âš ï¸ CLS ë°œìƒ: ${clsScore.toFixed(4)} (ì˜ˆìƒì¹˜ ëª»í•œ ê²°ê³¼)`,
            'important',
          )
        }

        if (fontApplied) {
          addTimelineEvent(
            'ê²°ë¡ : í°íŠ¸ê°€ 100ms ì´ë‚´ì— ë¡œë“œë˜ì–´ OptionalFontê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.',
          )
        } else {
          addTimelineEvent(
            'ê²°ë¡ : í°íŠ¸ê°€ 100ms ì´ë‚´ì— ë¡œë“œë˜ì§€ ì•Šì•„ ì‹œìŠ¤í…œ í°íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´í›„ í°íŠ¸ê°€ ë„ì°©í•´ë„ êµì²´ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
          )
        }
      }, 5000)
    </script>
  </body>
</html>
